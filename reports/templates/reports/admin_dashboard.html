{% extends "base.html" %}
{% block title %}Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±{% endblock %}

{% block head %}
<style>
  /* ===== Scoped: Admin Dashboard ===== */
  .dash{max-width:1100px;margin:auto;padding:14px}
  .dash-title{
    margin:0;
    font-weight:950;
    font-size:1.25rem;
    color:var(--ink);
  }
  .dash-sub{
    margin:6px 0 0;
    color:var(--muted);
    font-weight:800;
  }

  /* KPIs */
  .kpis{display:grid;gap:12px;margin-top:12px}
  @media(min-width:700px){.kpis{grid-template-columns:repeat(5,minmax(0,1fr))}}
  .kpi{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:14px;
    padding:16px;
    box-shadow:0 10px 26px rgba(2,6,23,.08);
    position:relative;
    overflow:hidden;
  }
  .kpi:before{
    content:"";
    position:absolute; inset:0 auto auto 0;
    height:4px; width:100%;
    background:linear-gradient(90deg,var(--brand),var(--accent));
    opacity:.85;
  }
  .kpi .num{font-weight:950;font-size:1.35rem;color:var(--brand)}
  .kpi .lbl{color:var(--muted);font-weight:850;margin-top:6px}

  /* Tiles */
  .grid{display:grid;gap:14px;margin-top:16px}
  @media(min-width:900px){.grid{grid-template-columns:1fr 1fr}}

  .tile{
    display:flex;
    gap:12px;
    align-items:center;
    background:var(--card);
    border:1px solid var(--line);
    border-radius:14px;
    padding:16px;
    text-decoration:none;
    color:inherit;
    box-shadow:0 10px 26px rgba(2,6,23,.08);
    transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
  }
  .tile:hover{
    transform:translateY(-2px);
    border-color:rgba(37,99,235,.25);
    background:rgba(37,99,235,.04);
    box-shadow:0 18px 40px rgba(2,6,23,.12);
  }
  .tile:focus-visible{
    outline:none;
    box-shadow:var(--ring), 0 18px 40px rgba(2,6,23,.12);
  }
  .tile.disabled{
    opacity:.6;
    pointer-events:none;
    transform:none;
    box-shadow:0 10px 26px rgba(2,6,23,.08);
  }

  .ico{
    width:46px;height:46px;border-radius:12px;
    display:grid;place-items:center;
    color:#fff;font-weight:950;
    flex:0 0 auto;
  }
  .b1{background:linear-gradient(135deg,#2563eb,#60a5fa)}
  .b2{background:linear-gradient(135deg,#10b981,#34d399)}
  .b3{background:linear-gradient(135deg,#7c3aed,#a78bfa)}
  .b4{background:linear-gradient(135deg,#f59e0b,#fbbf24)}
  .b5{background:linear-gradient(135deg,#0ea5e9,#22d3ee)}
  .b6{background:linear-gradient(135deg,#8b5cf6,#7c3aed)}
  .b7{background:linear-gradient(135deg,#f97316,#ea580c)}

  .tile-title{
    font-weight:950;
    margin:0;
    color:var(--ink);
    font-size:1.05rem;
  }
  .muted{
    margin-top:4px;
    color:var(--muted);
    font-weight:800;
  }

  /* Dark mode refinement (Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³ :root) */
  @media (prefers-color-scheme:dark){
    .tile:hover{background:rgba(59,130,246,.10);border-color:rgba(59,130,246,.25)}
    .kpi, .tile{box-shadow:0 10px 30px rgba(0,0,0,.22)}
  }
</style>
{% endblock %}

{% block content %}
<div class="dash" dir="rtl">
  <header>
    <h1 class="dash-title">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±</h1>
    <p class="dash-sub">Ù†Ø¸Ø±Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰</p>
  </header>

  <section class="kpis" aria-label="Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©">
    <div class="kpi">
      <div class="num">{{ reports_count }}</div>
      <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
    </div>

    <div class="kpi">
      <div class="num">{{ teachers_count }}</div>
      <div class="lbl">Ø§Ù„Ù…Ø¹Ù„Ù‘Ù…ÙˆÙ†</div>
    </div>

    <div class="kpi">
      <div class="num">{{ tickets_total }}</div>
      <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
    </div>

    <div class="kpi">
      <div class="num">{{ tickets_open }}</div>
      <div class="lbl">Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©/Ù‚ÙŠØ¯</div>
    </div>

    {% if reporttypes_count %}
      <div class="kpi">
        <div class="num">{{ reporttypes_count }}</div>
        <div class="lbl">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
      </div>
    {% endif %}
  </section>

  <section class="grid" aria-label="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª">
    <a class="tile" href="{% url 'reports:admin_reports' %}">
      <div class="ico b1" aria-hidden="true">ğŸ“„</div>
      <div>
        <div class="tile-title">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
        <div class="muted">Ø¹Ø±Ø¶/ØªØµÙÙŠØ© ÙˆØ­Ø°Ù Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
      </div>
    </a>

    {# ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: Ø¥Ù† ÙƒØ§Ù† Ø§Ù„Ù…Ø³Ø§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø¯Ùƒ ØºÙŠÙ‘Ø±Ù‡ Ù„Ø§Ø³Ù… URL Ø§Ù„ØµØ­ÙŠØ­ Ø£Ùˆ Ø§Ø¹Ø±Ø¶Ù‡Ø§ disabled #}
    {% url 'reports:tickets_inbox' as inbox_url %}
    {% if inbox_url %}
      <a class="tile" href="{{ inbox_url }}">
        <div class="ico b2" aria-hidden="true">ğŸ“¬</div>
        <div>
          <div class="tile-title">ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
          <div class="muted">ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ­Ø§Ù„Ø§ØªÙ‡Ø§</div>
        </div>
      </a>
    {% else %}
      <div class="tile disabled">
        <div class="ico b2" aria-hidden="true">ğŸ“¬</div>
        <div>
          <div class="tile-title">ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
          <div class="muted">Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹</div>
        </div>
      </div>
    {% endif %}

    <a class="tile" href="{% url 'reports:manage_teachers' %}">
      <div class="ico b4" aria-hidden="true">ğŸ‘©â€ğŸ«</div>
      <div>
        <div class="tile-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù„Ù‘Ù…ÙŠÙ†</div>
        <div class="muted">Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù</div>
      </div>
    </a>

    {% if CAN_SEND_NOTIFICATIONS and SEND_NOTIFICATION_URL %}
      <a class="tile" href="{{ SEND_NOTIFICATION_URL }}">
        <div class="ico b5" aria-hidden="true">ğŸ“£</div>
        <div>
          <div class="tile-title">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±</div>
          <div class="muted">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†/Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</div>
        </div>
      </a>
    {% endif %}

    <a class="tile" href="{% url 'reports:departments_list' %}">
      <div class="ico b3" aria-hidden="true">ğŸ·ï¸</div>
      <div>
        <div class="tile-title">Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</div>
        <div class="muted">
          {% if has_dept_model %}Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù/Ø£Ø¹Ø¶Ø§Ø¡{% else %}Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ ÙÙ‚Ø· (Ù…Ù† ROLE_CHOICES){% endif %}
        </div>
      </div>
    </a>

    <a class="tile" href="{% url 'reports:school_audit_logs' %}">
      <div class="ico b7" aria-hidden="true">ğŸ“œ</div>
      <div>
        <div class="tile-title">Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
        <div class="muted">Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª ÙˆØ§Ù„Ø­Ø°Ù</div>
      </div>
    </a>

    {% if has_reporttype %}
      <a class="tile" href="{% url 'reports:reporttypes_list' %}">
        <div class="ico b5" aria-hidden="true">ğŸ§©</div>
        <div>
          <div class="tile-title">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
          <div class="muted">Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ (ØªØ¸Ù‡Ø± ÙÙŠ â€œÙ†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±â€)</div>
        </div>
      </a>
    {% else %}
      <div class="tile disabled">
        <div class="ico b5" aria-hidden="true">ğŸ§©</div>
        <div>
          <div class="tile-title">Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
          <div class="muted">ÙØ¹Ù‘Ù„ ReportType ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
        </div>
      </div>
    {% endif %}

    {% if active_school %}
      {% url 'reports:school_settings' as school_settings_url %}
      {% if school_settings_url %}
        <a class="tile" href="{{ school_settings_url }}">
          <div class="ico b4" aria-hidden="true">âš™ï¸</div>
          <div>
            <div class="tile-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
            <div class="muted">ØªØ¹Ø¯ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø© ÙˆØ´Ø¹Ø§Ø±Ù‡Ø§ Ø§Ù„Ù†Ø´Ø· Ø­Ø§Ù„ÙŠØ§Ù‹</div>
          </div>
        </a>
      {% else %}
        <div class="tile disabled">
          <div class="ico b4" aria-hidden="true">âš™ï¸</div>
          <div>
            <div class="tile-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
            <div class="muted">Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹</div>
          </div>
        </div>
      {% endif %}

      <a class="tile" href="{% url 'reports:my_subscription' %}">
        <div class="ico b6" aria-hidden="true">ğŸ’³</div>
        <div>
          <div class="tile-title">Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØ§Ù„Ø¨Ø§Ù‚Ø§Øª</div>
          <div class="muted">Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø¨Ø§Ù‚Ø©</div>
        </div>
      </a>
    {% endif %}

    <a class="tile" href="{% url 'reports:my_support_tickets' %}">
      <div class="ico b7" aria-hidden="true">ğŸ§</div>
      <div>
        <div class="tile-title">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ù„Ù„Ù…Ù†ØµØ©</div>
        <div class="muted">ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù„Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªÙ‚Ù†ÙŠØ©</div>
      </div>
    </a>
  </section>
</div>
{% endblock %}
