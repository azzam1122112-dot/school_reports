{% extends "base.html" %}
{% block title %}تذاكر الدعم الفني (المنصة){% endblock %}

{% block content %}
<div class="container" dir="rtl">
  <div class="page-head">
    <div>
      <h1 class="page-title">تذاكر الدعم الفني (المنصة)</h1>
      <p class="page-subtitle">متابعة تذاكر الدعم للمدارس على مستوى المنصة.</p>
    </div>
    <a href="{% url 'reports:platform_admin_dashboard' %}" class="btn btn-outline">عودة للوحة المنصة</a>
  </div>

  <div class="card table-responsive">
    <table class="rtable">
      <thead>
        <tr>
          <th style="text-align:right">رقم التذكرة</th>
          <th style="text-align:right">العنوان</th>
          <th style="text-align:right">المرسل</th>
          <th>التاريخ</th>
          <th>الحالة</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody>
        {% for ticket in tickets %}
        <tr>
          <td data-label="#" style="text-align:right;font-family:monospace;font-weight:950">#{{ ticket.id }}</td>
          <td data-label="العنوان" style="text-align:right;font-weight:900">{{ ticket.title }}</td>
          <td data-label="المرسل" style="text-align:right">
            <div style="font-weight:900">{{ ticket.creator.name }}</div>
            <div class="muted" style="font-weight:850;font-size:.9rem">{{ ticket.creator.phone }}</div>
          </td>
          <td data-label="التاريخ">{{ ticket.created_at|date:"Y-m-d H:i" }}</td>
          <td data-label="الحالة">
            {% if ticket.status == 'open' %}
              <span class="badge info">جديد</span>
            {% elif ticket.status == 'in_progress' %}
              <span class="badge warning">قيد المعالجة</span>
            {% elif ticket.status == 'done' %}
              <span class="badge success">مكتمل</span>
            {% else %}
              <span class="badge danger">مرفوض</span>
            {% endif %}
          </td>
          <td data-label="إجراء">
            <a href="{% url 'reports:ticket_detail' ticket.id %}" class="btn btn-outline" style="min-height:38px;padding:8px 10px">عرض</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" style="padding:20px;text-align:center" class="muted">لا توجد تذاكر دعم فني.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
