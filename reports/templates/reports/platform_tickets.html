{% extends "base.html" %}
{% block title %}تذاكر الدعم الفني (المنصة){% endblock %}

{% block content %}
<div class="wrap" dir="rtl">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
    <h1 class="title">تذاكر الدعم الفني (المنصة)</h1>
    <a href="{% url 'reports:platform_admin_dashboard' %}" class="btn">عودة</a>
  </div>

  <div class="card" style="background:#fff;border-radius:14px;border:1px solid var(--line);overflow:hidden">
    <div style="overflow-x:auto">
      <table style="width:100%;border-collapse:collapse;min-width:800px">
        <thead>
          <tr style="background:var(--bg);text-align:right">
            <th style="padding:12px;border-bottom:1px solid var(--line)">رقم التذكرة</th>
            <th style="padding:12px;border-bottom:1px solid var(--line)">العنوان</th>
            <th style="padding:12px;border-bottom:1px solid var(--line)">المرسل</th>
            <th style="padding:12px;border-bottom:1px solid var(--line)">التاريخ</th>
            <th style="padding:12px;border-bottom:1px solid var(--line)">الحالة</th>
            <th style="padding:12px;border-bottom:1px solid var(--line)">إجراءات</th>
          </tr>
        </thead>
        <tbody>
          {% for ticket in tickets %}
          <tr style="border-bottom:1px solid var(--line-2)">
            <td style="padding:12px;font-family:monospace">#{{ ticket.id }}</td>
            <td style="padding:12px;font-weight:bold">{{ ticket.title }}</td>
            <td style="padding:12px">
                {{ ticket.creator.name }}
                <div style="font-size:0.8rem;color:var(--muted)">{{ ticket.creator.phone }}</div>
            </td>
            <td style="padding:12px">{{ ticket.created_at|date:"Y-m-d H:i" }}</td>
            <td style="padding:12px">
                {% if ticket.status == 'open' %}
                <span style="background:#dbeafe;color:#1e40af;padding:4px 8px;border-radius:99px;font-size:0.85rem;font-weight:bold">جديد</span>
                {% elif ticket.status == 'in_progress' %}
                <span style="background:#fef3c7;color:#92400e;padding:4px 8px;border-radius:99px;font-size:0.85rem;font-weight:bold">قيد المعالجة</span>
                {% elif ticket.status == 'done' %}
                <span style="background:#dcfce7;color:#166534;padding:4px 8px;border-radius:99px;font-size:0.85rem;font-weight:bold">مكتمل</span>
                {% else %}
                <span style="background:#fee2e2;color:#991b1b;padding:4px 8px;border-radius:99px;font-size:0.85rem;font-weight:bold">مرفوض</span>
                {% endif %}
            </td>
            <td style="padding:12px">
                <a href="{% url 'reports:ticket_detail' ticket.id %}" class="btn" style="padding:4px 10px;font-size:0.85rem">عرض</a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" style="padding:20px;text-align:center;color:var(--muted)">لا توجد تذاكر دعم فني.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
