{% extends "base.html" %}
{% block title %}بروفايل المدرسة{% endblock %}

{% block content %}
<div class="container" dir="rtl">
  <div class="page-head" style="max-width:980px;margin-inline:auto">
    <div>
      <h1 class="page-title">بروفايل المدرسة</h1>
      <p class="page-subtitle">نظرة عامة على بيانات المدرسة وإحصائياتها.</p>
    </div>
    <a href="{% url 'reports:schools_admin_list' %}" class="btn btn-outline">عودة للقائمة</a>
  </div>

  <div style="max-width:980px;margin-inline:auto">
    <div class="card">
      <div class="section-title">بيانات المدرسة</div>
      <div class="card-row"><span>اسم المدرسة</span><b>{{ school.name }}</b></div>
      <div class="card-row"><span>المرحلة</span><b>{{ school.get_stage_display }}</b></div>
      <div class="card-row"><span>بنين / بنات</span><b>{{ school.get_gender_display }}</b></div>
      <div class="card-row"><span>المدينة</span><b>{{ school.city|default:"-" }}</b></div>
      <div class="card-row"><span>رقم الجوال</span><b>{{ school.phone|default:"-" }}</b></div>
      <div style="margin-top:10px">
        {% if school.is_active %}
          <span class="badge success">نشطة</span>
        {% else %}
          <span class="badge danger">موقوفة</span>
        {% endif %}
      </div>
    </div>

    <div style="height:12px"></div>

    <div class="kpi-grid">
      <div class="kpi">
        <div><div class="num">{{ reports_count }}</div><div class="lbl">عدد التقارير</div></div>
        <div class="kpi-ico info">R</div>
      </div>
      <div class="kpi">
        <div><div class="num">{{ tickets_total }}</div><div class="lbl">التذاكر (الكل)</div></div>
        <div class="kpi-ico warn">T</div>
      </div>
      <div class="kpi">
        <div><div class="num">{{ departments_count }}</div><div class="lbl">الأقسام</div></div>
        <div class="kpi-ico info">D</div>
      </div>
      <div class="kpi">
        <div><div class="num">{{ teachers_count }}</div><div class="lbl">المعلمين</div></div>
        <div class="kpi-ico ok">M</div>
      </div>
    </div>

    <div style="height:12px"></div>

    <div class="card">
      <div class="section-title">تفاصيل التذاكر</div>
      <div class="card-row"><span>مفتوحة / تحت المعالجة</span><b>{{ tickets_open }}</b></div>
      <div class="card-row"><span>مغلقة</span><b>{{ tickets_done }}</b></div>
      <div class="card-row"><span>مرفوضة</span><b>{{ tickets_rejected }}</b></div>
    </div>

    <div style="height:12px"></div>

    <div style="display:grid;grid-template-columns:1fr;gap:12px">
      <div class="card">
        <div class="section-title">أمثلة أقسام (بحد أقصى 20)</div>
        {% if departments %}
          <ul style="margin:0;padding-right:18px">
            {% for d in departments %}
              <li>{{ d.name }}</li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="muted" style="font-weight:900">لا توجد أقسام لعرضها.</div>
        {% endif %}
      </div>
      <div class="card">
        <div class="section-title">أمثلة معلمين (بحد أقصى 20)</div>
        {% if teachers %}
          <ul style="margin:0;padding-right:18px">
            {% for t in teachers %}
              <li>{{ t.name }}</li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="muted" style="font-weight:900">لا يوجد معلمين لعرضهم.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
