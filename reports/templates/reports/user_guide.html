{% load static %}
<!doctype html>
<html lang="ar" dir="rtl" class="scroll-smooth">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#2563eb">
  <meta name="color-scheme" content="light dark">

  <title>دليل المستخدم | منصة توثيق</title>
  <meta name="description" content="دليل المستخدم الشامل لمنصة توثيق — شرح التقارير وملف الإنجاز والتذاكر والإشعارات والتعاميم والمشاركة والطباعة.">

  <link rel="manifest" href="{% static 'manifest.json' %}">
  <link rel="icon" href="{% static 'img/logo1.png' %}">
  <link rel="apple-touch-icon" href="{% static 'img/logo1.png' %}">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <style>
    :root {
      --brand: #2563eb;
      --brand-dark: #0f368e;
      --brand-light: #eff6ff;
      --surface: #ffffff;
      --bg-body: #f8fafc;
      --text-main: #0f172a;
      --text-secondary: #475569;
      --border: #e2e8f0;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);
      --container: 1100px;
      --radius: 18px;
      --nav-height: 78px;
    }

    html { scroll-behavior: smooth; font-size: 16px; }
    body {
      margin: 0;
      font-family: 'Tajawal', sans-serif;
      background: var(--bg-body);
      background-image:
        radial-gradient(at 0% 0%, rgba(37,99,235,0.08) 0px, transparent 50%),
        radial-gradient(at 100% 0%, rgba(37,99,235,0.04) 0px, transparent 50%);
      background-attachment: fixed;
      color: var(--text-main);
      line-height: 1.75;
    }

    *, *::before, *::after { box-sizing: border-box; }
    a { color: inherit; text-decoration: none; transition: all 0.2s ease; }

    .container { width: 92%; max-width: var(--container); margin: 0 auto; }
    .flex { display: flex; }
    .items-center { align-items: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 12px; }

    .navbar {
      height: var(--nav-height);
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.86);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0,0,0,0.03);
    }

    .logo {
      font-size: 1.1rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      gap: 12px;
      color: var(--text-main);
    }
    .logo img { height: 40px; width: auto; }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      padding: 12px 18px;
      border-radius: 12px;
      font-weight: 800;
      font-size: 0.95rem;
      border: 1px solid transparent;
    }
    .btn-primary {
      background: var(--brand);
      color: white;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.22);
    }
    .btn-primary:hover { background: var(--brand-dark); transform: translateY(-1px); }

    .btn-outline {
      background: rgba(255,255,255,0.95);
      border-color: var(--border);
      color: var(--text-main);
      box-shadow: var(--shadow-sm);
    }
    .btn-outline:hover { border-color: rgba(37,99,235,0.35); color: var(--brand); background: var(--brand-light); }

    .hero { padding: 44px 0 22px; }

    .card {
      background: rgba(255, 255, 255, 0.92);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      overflow: hidden;
    }

    .hero-inner { padding: 26px; display: flex; flex-direction: column; gap: 16px; }
    .title { font-size: 2.0rem; font-weight: 900; letter-spacing: -0.5px; margin: 0; }
    .subtitle { margin: 0; color: var(--text-secondary); font-weight: 700; }
    .actions { display: flex; gap: 12px; flex-wrap: wrap; }

    .doc { padding: 26px; }

    .doc :is(h1,h2,h3,h4) { color: var(--text-main); margin: 28px 0 12px; line-height: 1.35; }
    .doc h1 { font-size: 2rem; }
    .doc h2 { font-size: 1.5rem; }
    .doc h3 { font-size: 1.2rem; }
    .doc p { margin: 10px 0; color: var(--text-secondary); font-weight: 600; }
    .doc ul { margin: 10px 0 10px; padding-right: 20px; }
    .doc li { margin: 8px 0; color: var(--text-secondary); font-weight: 650; }

    .doc a { color: var(--brand); font-weight: 800; }
    .doc a:hover { text-decoration: underline; }

    .doc hr { border: 0; height: 1px; background: var(--border); margin: 22px 0; }

    .doc code {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: rgba(15, 23, 42, 0.04);
      padding: 2px 8px;
      border-radius: 10px;
      font-weight: 800;
      color: var(--text-main);
    }

    .doc pre {
      background: rgba(15, 23, 42, 0.92);
      color: #e2e8f0;
      padding: 16px;
      border-radius: 16px;
      overflow-x: auto;
      box-shadow: var(--shadow-xl);
    }
    .doc pre code { background: transparent; padding: 0; color: inherit; }

    .doc table {
      width: 100%;
      border-collapse: collapse;
      margin: 14px 0 20px;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      display: block;
    }
    .doc thead { background: rgba(37,99,235,0.06); }
    .doc th, .doc td {
      padding: 12px 14px;
      border-bottom: 1px solid var(--border);
      color: var(--text-secondary);
      font-weight: 700;
      white-space: nowrap;
    }
    .doc th { color: var(--text-main); font-weight: 900; }

    @media (max-width: 768px) {
      .title { font-size: 1.6rem; }
      .doc { padding: 18px; }
      .hero-inner { padding: 18px; }
    }
  </style>
</head>

<body>
  <nav class="navbar" aria-label="القائمة الرئيسية">
    <div class="container flex items-center justify-between" style="height: var(--nav-height);">
      <a href="{% url 'reports:landing' %}" class="logo">
        <img src="{% static 'img/logo1.png' %}" alt="Logo">
        <span>منصة توثيق</span>
      </a>
      <div class="flex items-center gap-2">
        <a href="{% url 'reports:landing' %}" class="btn btn-outline">
          <i class="fa-solid fa-house"></i>
          الرئيسية
        </a>
        <a href="{% url 'reports:login' %}" class="btn btn-primary">
          <i class="fa-solid fa-right-to-bracket"></i>
          تسجيل الدخول
        </a>
      </div>
    </div>
  </nav>

  <header class="hero">
    <div class="container">
      <div class="card">
        <div class="hero-inner">
          <h1 class="title">دليل المستخدم الشامل</h1>
          <p class="subtitle">شرح عملي مطابق لشاشات النظام: التقارير، ملف الإنجاز، التذاكر، الإشعارات والتعاميم، المشاركة والطباعة.</p>
          <div class="actions">
            <a href="{{ download_url }}" class="btn btn-outline">
              <i class="fa-solid fa-download"></i>
              تنزيل الدليل (Markdown)
            </a>
            <a href="{{ download_pdf_url }}" class="btn btn-outline">
              <i class="fa-solid fa-file-pdf"></i>
              تنزيل الدليل (PDF)
            </a>
          </div>
        </div>
        <main class="doc" id="content">
          {{ guide_html|safe }}
        </main>
      </div>
    </div>
  </header>

  <script>
    // Register Service Worker (root scope)
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js').catch(function(err) {});
      });
    }
  </script>
</body>
</html>
