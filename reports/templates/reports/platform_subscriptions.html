{% extends "base.html" %}
{% block title %}إدارة الاشتراكات{% endblock %}

{% block content %}
<div class="container" dir="rtl">
  <div class="page-head">
    <div>
      <h1 class="page-title">إدارة الاشتراكات</h1>
      <p class="page-subtitle">تجديد وتعديل اشتراكات المدارس على مستوى المنصة.</p>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <a href="{% url 'reports:platform_subscription_add' %}" class="btn btn-primary">إضافة اشتراك</a>
      <a href="{% url 'reports:platform_admin_dashboard' %}" class="btn btn-outline">عودة للوحة المنصة</a>
    </div>
  </div>

  <div class="card table-responsive">
    <table class="rtable">
      <thead>
        <tr>
          <th style="text-align:right">المدرسة</th>
          <th style="text-align:right">الخطة</th>
          <th>تاريخ البدء</th>
          <th>تاريخ الانتهاء</th>
          <th>الحالة</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody>
        {% for sub in subscriptions %}
        <tr>
          <td data-label="المدرسة" style="text-align:right;font-weight:950">{{ sub.school.name }}</td>
          <td data-label="الخطة" style="text-align:right">{{ sub.plan.name }}</td>
          <td data-label="البدء">{{ sub.start_date|date:"Y-m-d" }}</td>
          <td data-label="الانتهاء">{{ sub.end_date|date:"Y-m-d" }}</td>
          <td data-label="الحالة">
            {% if sub.is_active %}
              <span class="badge success">نشط</span>
            {% else %}
              <span class="badge danger">منتهي/غير نشط</span>
            {% endif %}
          </td>
          <td data-label="إجراء">
            <a href="{% url 'reports:platform_subscription_edit' sub.id %}" class="btn btn-outline" style="min-height:38px;padding:8px 10px">تعديل</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" style="padding:20px;text-align:center" class="muted">لا توجد اشتراكات مسجلة.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
