{# reports/templates/reports/platform_admin_dashboard.html (Ù…Ø«Ø§Ù„ Ø§Ø³Ù…) #}
{% extends "base.html" %}
{% load static %}

{% block title %}Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ©{% endblock %}

{% block head %}
<style>
  /* =========================================================
     PLATFORM ADMIN DASHBOARD (page-only) â€” Scoped Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
     - Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³ :root
     - Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ .btn / .card Ø§Ù„Ø¹Ø§Ù…Ø©
     - Ø¯Ø¹Ù… data-theme (Dark/Light)
     ========================================================= */

  .platform-admin{
    --pa-brand: var(--brand, #2563eb);
    --pa-accent: var(--accent, #10b981);
    --pa-danger: var(--danger, #ef4444);
    --pa-ink: var(--ink, #0f172a);
    --pa-muted: var(--muted, #64748b);
    --pa-line: var(--line-2, var(--line, #e5e7eb));
    --pa-card: var(--card, #fff);
    --pa-shadow: var(--shadow, 0 14px 36px rgba(2,6,23,.10));
    --pa-radius: 18px;
    --pa-t: var(--t-fast, all .2s ease);
  }

  /* Hero */
  .platform-admin .page-hero{
    padding: 14px 18px;
    margin-top: 10px;
    margin-bottom: 10px;
    border: 1px solid rgba(255,255,255,.14);
    background:
      radial-gradient(900px 240px at 20% 0%, rgba(37,99,235,.22), transparent 55%),
      radial-gradient(700px 260px at 85% 75%, rgba(16,185,129,.16), transparent 60%),
      linear-gradient(135deg, rgba(37,99,235,.96), rgba(14,165,233,.88));
    color:#fff;
    border-radius: var(--pa-radius);
    overflow:hidden;
    box-shadow: var(--pa-shadow);
  }

  .platform-admin .page-head{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:10px;
    margin:0;
    flex-wrap:wrap;
  }

  .platform-admin .page-title{
    margin:0;
    font-weight: 950;
    letter-spacing: -.3px;
    line-height: 1.2;
    color:#fff;
    font-size: clamp(1.2rem, 2.2vw, 1.6rem);
  }

  .platform-admin .page-subtitle{
    margin:6px 0 0;
    color: rgba(255,255,255,.92);
    font-weight: 850;
    max-width: 760px;
  }

  /* Badge */
  .platform-admin .hero-badge{
    display:flex;
    align-items:center;
    gap:10px;
    padding: 10px 12px;
    border-radius: 999px;
    background: rgba(255,255,255,.14);
    border: 1px solid rgba(255,255,255,.22);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }
  .platform-admin .hero-ava{
    width: 40px;
    height: 40px;
    border-radius: 999px;
    display:grid;
    place-items:center;
    background: rgba(255,255,255,.92);
    color: var(--pa-brand);
    font-weight: 950;
    flex: 0 0 auto;
  }

  /* KPI Grid */
  .platform-admin .kpi-grid{
    display:grid;
    gap:12px;
    margin-top: 12px;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  }

  .platform-admin .kpi{
    border-radius: 16px;
    border: 1px solid var(--pa-line);
    background: linear-gradient(180deg, var(--pa-card), var(--line-2, #f6f8fb));
    padding: 14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    box-shadow: var(--pa-shadow);
    transition: var(--pa-t);
    position:relative;
    overflow:hidden;
  }
  .platform-admin .kpi:hover{
    transform: translateY(-2px);
    box-shadow: 0 20px 44px rgba(2,6,23,.12);
  }

  html[data-theme="dark"] .platform-admin .kpi{
    background: linear-gradient(180deg, rgba(18,32,67,.92), rgba(15,22,41,.92));
    border-color:#1b2744;
    box-shadow: 0 18px 44px rgba(0,0,0,.26);
  }

  .platform-admin .kpi .num{
    font-weight: 950;
    font-size: clamp(1.25rem, 2.4vw, 1.7rem);
    color: var(--pa-ink);
    line-height:1.05;
  }
  .platform-admin .kpi .lbl{
    margin-top: 6px;
    font-weight: 850;
    color: var(--pa-muted);
    font-size: .95rem;
  }

  .platform-admin .kpi-ico{
    width: 44px;
    height: 44px;
    border-radius: 16px;
    display:grid;
    place-items:center;
    font-size: 1.25rem;
    border: 1px solid rgba(15,23,42,.06);
    background: rgba(255,255,255,.70);
  }
  html[data-theme="dark"] .platform-admin .kpi-ico{
    background: rgba(255,255,255,.06);
    border-color: rgba(148,163,184,.18);
  }

  .platform-admin .kpi-ico.ok{ color: #10b981; }
  .platform-admin .kpi-ico.info{ color: #2563eb; }
  .platform-admin .kpi-ico.warn{ color: #f59e0b; }
  .platform-admin .kpi-ico.danger{ color: #ef4444; }

  /* Actions */
  .platform-admin .actions-grid{
    display:grid;
    gap:12px;
    margin-top:14px;
  }
  @media(min-width: 900px){
    .platform-admin .actions-grid{grid-template-columns:1fr 1fr}
  }

  .platform-admin .tile{
    display:flex;
    gap:12px;
    align-items:center;
    text-decoration:none;
    color: inherit;
    padding: 14px;
    border-radius: 16px;
    transition: var(--pa-t);
  }
  .platform-admin .tile:hover{
    background: rgba(37,99,235,.04);
    border-color: rgba(37,99,235,.20);
    transform: translateY(-1px);
  }
  html[data-theme="dark"] .platform-admin .tile:hover{
    background: rgba(37,99,235,.10);
    border-color: rgba(59,130,246,.22);
  }

  .platform-admin .tile .ico{
    width:46px;height:46px;
    border-radius: 14px;
    display:grid;
    place-items:center;
    font-weight: 950;
    border: 1px solid rgba(15,23,42,.06);
    background: rgba(255,255,255,.70);
    color: var(--pa-brand);
    flex: 0 0 auto;
    font-size: 1.2rem;
  }
  html[data-theme="dark"] .platform-admin .tile .ico{
    background: rgba(255,255,255,.06);
    border-color: rgba(148,163,184,.18);
  }

  .platform-admin .tile .t-title{
    margin:0;
    font-weight:950;
    color: var(--pa-ink);
    font-size: 1.02rem;
  }
  .platform-admin .tile .t-sub{
    margin-top:4px;
    color: var(--pa-muted);
    font-weight: 850;
  }

  /* Mobile */
  @media(max-width:520px){
    .platform-admin .page-hero{padding:14px}
    .platform-admin .actions-grid{grid-template-columns:1fr}
    .platform-admin .tile{align-items:flex-start}
  }

  /* Reduce motion */
  @media (prefers-reduced-motion: reduce){
    .platform-admin .kpi,
    .platform-admin .tile{
      transition:none !important;
    }
    .platform-admin .kpi:hover,
    .platform-admin .tile:hover{
      transform:none !important;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="container platform-admin" dir="rtl">

  <section class="card page-hero" aria-label="Ø±Ø£Ø³ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù†ØµØ©">
    <div class="page-head">
      <div>
        <h1 class="page-title">Ù„ÙˆØ­Ø© Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</h1>
        <p class="page-subtitle">
          Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¹Ø§Ù…Ø© ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù… ÙÙ‚Ø·.
        </p>
      </div>

      <div class="hero-badge" title="Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø§Ù„ÙŠ">
        {% firstof request.user.name request.user.phone "System Admin" as display_name %}
        <div class="hero-ava" aria-hidden="true">{{ display_name|slice:":1" }}</div>
        <div>
          <div style="font-weight:950;line-height:1">{{ display_name }}</div>
          <div style="opacity:.92;font-weight:900;font-size:.85rem;margin-top:3px">Ù…Ø´Ø±Ù Ø¹Ø§Ù…</div>
        </div>
      </div>
    </div>
  </section>

  <section class="kpi-grid" aria-label="Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©">
    <div class="kpi">
      <div>
        <div class="num">{{ platform_schools_active|default:"0" }}</div>
        <div class="lbl">Ù…Ø¯Ø§Ø±Ø³ Ù†Ø´Ø·Ø©</div>
      </div>
      <div class="kpi-ico ok" aria-hidden="true">ğŸ«</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ platform_schools_total|default:"0" }}</div>
        <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
      </div>
      <div class="kpi-ico info" aria-hidden="true">ğŸ·ï¸</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ subscriptions_expiring_soon|default:"0" }}</div>
        <div class="lbl">ØªÙ†ØªÙ‡ÙŠ Ù‚Ø±ÙŠØ¨Ø§Ù‹</div>
      </div>
      <div class="kpi-ico warn" aria-hidden="true">â³</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ subscriptions_expired|default:"0" }}</div>
        <div class="lbl">Ù…Ù†ØªÙ‡ÙŠØ©</div>
      </div>
      <div class="kpi-ico danger" aria-hidden="true">â›”</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ pending_payments|default:"0" }}</div>
        <div class="lbl">Ù…Ø¯ÙÙˆØ¹Ø§Øª Ù…Ø¹Ù„Ù‘Ù‚Ø©</div>
      </div>
      <div class="kpi-ico warn" aria-hidden="true">ğŸ’³</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ total_revenue|default:"0" }}</div>
        <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
      </div>
      <div class="kpi-ico ok" aria-hidden="true">ğŸ’°</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ tickets_open|default:"0" }}</div>
        <div class="lbl">ØªØ°Ø§ÙƒØ± Ø¯Ø¹Ù… ÙÙ†ÙŠ</div>
      </div>
      <div class="kpi-ico info" aria-hidden="true">ğŸ§</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{{ reports_count|default:"0" }}</div>
        <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
      </div>
      <div class="kpi-ico info" aria-hidden="true">ğŸ“„</div>
    </div>
  </section>

  <section class="actions-grid" aria-label="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…">
    <a class="card tile" href="{% url 'reports:platform_admins_list' %}">
      <div class="ico" aria-hidden="true">ğŸ§‘â€ğŸ’¼</div>
      <div>
        <div class="t-title">Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</div>
        <div class="t-sub">Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù ÙˆØ¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:schools_admin_list' %}">
      <div class="ico" aria-hidden="true">ğŸ«</div>
      <div>
        <div class="t-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
        <div class="t-sub">Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„/Ø­Ø°Ù Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ ÙˆØªØ¹ÙŠÙŠÙ† Ù…Ø¯Ø±Ø§Ø¡ Ù„Ù‡Ø§</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:school_managers_list' %}">
      <div class="ico" aria-hidden="true">ğŸ‘¨â€ğŸ’¼</div>
      <div>
        <div class="t-title">Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
        <div class="t-sub">Ø¥Ù†Ø´Ø§Ø¡/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡ ÙˆØ±Ø¨Ø·Ù‡Ù… Ø¨Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:platform_subscriptions_list' %}">
      <div class="ico" aria-hidden="true">ğŸ“…</div>
      <div>
        <div class="t-title">Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª</div>
        <div class="t-sub">ØªØ¬Ø¯ÙŠØ¯ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:platform_plans_list' %}">
      <div class="ico" aria-hidden="true">ğŸ“</div>
      <div>
        <div class="t-title">Ø®Ø·Ø· Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</div>
        <div class="t-sub">Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:platform_payments_list' %}">
      <div class="ico" aria-hidden="true">ğŸ’°</div>
      <div>
        <div class="t-title">Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</div>
        <div class="t-sub">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:platform_tickets_list' %}">
      <div class="ico" aria-hidden="true">ğŸ§</div>
      <div>
        <div class="t-title">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</div>
        <div class="t-sub">Ù…ØªØ§Ø¨Ø¹Ø© ØªØ°Ø§ÙƒØ± Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'reports:admin_dashboard' %}">
      <div class="ico" aria-hidden="true">ğŸ“Š</div>
      <div>
        <div class="t-title">Ù„ÙˆØ­Ø© Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³</div>
        <div class="t-sub">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ÙˆØ­Ø© Ù…Ø¯ÙŠØ± Ù…Ø¯Ø±Ø³Ø© (Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ù†Ø´Ø·Ø©)</div>
      </div>
    </a>

    <a class="card tile" href="{% url 'admin:index' %}">
      <div class="ico" aria-hidden="true">âš™ï¸</div>
      <div>
        <div class="t-title">Ù„ÙˆØ­Ø© Django Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</div>
        <div class="t-sub">Ø¥Ø¯Ø§Ø±Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª</div>
      </div>
    </a>
  </section>

</div>
{% endblock %}
