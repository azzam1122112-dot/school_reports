{% extends "base.html" %}
{% block title %}Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±{% endblock %}

{% block head %}
<style>
  /* ===== Scoped Report Types ===== */
  .rt-scope{
    --ink: var(--ink, #0f172a);
    --muted: var(--muted, #6b7280);
    --line: var(--line, #e5e7eb);
    --card: var(--card, #ffffff);
    --brand: var(--brand, #2563eb);
    --accent: var(--accent, #10b981);
    --radius: 14px;
    --shadow: var(--shadow, 0 10px 26px rgba(2,6,23,.08));
  }

  .rt-scope .wrap{max-width:1000px;margin:24px auto;padding:0 16px}

  .rt-scope .top{
    display:flex;justify-content:space-between;align-items:center;gap:10px;
    margin-bottom:12px;flex-wrap:wrap
  }
  .rt-scope .top h1{
    margin:0;
    font-size:clamp(1.15rem, 2.4vw, 1.45rem);
    font-weight:900;
    color:var(--ink);
  }

  .rt-scope .muted{color:var(--muted);font-weight:800;line-height:1.9;margin:10px 0 14px}

  .rt-scope .btn{
    padding:10px 14px;border-radius:12px;border:1px solid var(--line);
    background:var(--card);font-weight:900;cursor:pointer;
    text-decoration:none;color:var(--ink);
    display:inline-flex;align-items:center;gap:8px;
    transition:transform .15s ease, filter .15s ease;
    min-height:44px;
  }
  .rt-scope .btn:hover{transform:translateY(-1px)}
  .rt-scope .btn:active{transform:none}

  .rt-scope .btn-primary{
    background:linear-gradient(135deg,var(--brand),#3b82f6);
    border-color:transparent;color:#fff
  }
  .rt-scope .btn-danger{
    background:#b91c1c;color:#fff;border-color:transparent
  }

  /* Table wrapper */
  .rt-scope .table-wrap{
    border:1px solid var(--line);
    border-radius:var(--radius);
    overflow:auto;
    background:transparent;
  }

  .rt-scope table{width:100%;border-collapse:separate;border-spacing:0;min-width:820px}
  .rt-scope thead th{
    position:sticky;top:0;z-index:1;
    background:#f8fafc;
    color:var(--muted);
    font-weight:900;
    text-align:right;
    border-bottom:1px solid var(--line);
    padding:12px 14px;
    white-space:nowrap;
  }
  .rt-scope tbody tr{background:var(--card)}
  .rt-scope tbody tr+tr td{border-top:1px solid #f3f4f6}
  .rt-scope td{
    padding:12px 14px;
    color:var(--ink);
    font-weight:800;
    vertical-align:middle;
    white-space:nowrap;
  }

  .rt-scope .badge{
    display:inline-flex;align-items:center;gap:6px;
    border-radius:999px;
    background:#eef2ff;
    color:#1f2937;
    padding:5px 10px;
    font-size:.85rem;
    font-weight:900;
    border:1px solid rgba(30,58,138,.14);
  }

  .rt-scope .actions{
    display:flex;flex-wrap:wrap;gap:8px;justify-content:flex-start;
  }
  .rt-scope .actions form{display:inline}
  .rt-scope .actions .btn{min-height:40px;padding:8px 12px;border-radius:10px}

  .rt-scope .empty{
    text-align:center;
    padding:18px;
    color:var(--muted);
    font-weight:900;
  }

  /* Mobile stacked cards */
  @media (max-width: 640px){
    .rt-scope .table-wrap{border:0}
    .rt-scope table, .rt-scope thead, .rt-scope tbody, .rt-scope th, .rt-scope tr{display:block}
    .rt-scope thead{display:none}
    .rt-scope tbody{display:grid;gap:12px;min-width:unset}
    .rt-scope tbody tr{
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .rt-scope tbody tr td{
      display:grid;
      grid-template-columns:8.5em 1fr;
      gap:10px;
      align-items:center;
      padding:10px 12px;
      border:0;
      border-bottom:1px solid #f1f5f9;
      white-space:normal;
    }
    .rt-scope tbody tr td:last-child{border-bottom:0}

    .rt-scope td::before{
      content:attr(data-label);
      font-weight:900;
      color:var(--muted);
    }

    .rt-scope td.actions{
      grid-template-columns:1fr;
      gap:10px;
    }
    .rt-scope td.actions .btn{width:100%;justify-content:center}
    .rt-scope table{min-width:unset}
  }
</style>
{% endblock %}

{% block content %}
<div class="rt-scope" dir="rtl">
  <div class="wrap">

    <div class="top">
      <h1>Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h1>
      {% if db_backed %}
        <a class="btn btn-primary" href="{% url 'reports:reporttype_create' %}">â• Ø¥Ø¶Ø§ÙØ© Ù†ÙˆØ¹</a>
      {% endif %}
    </div>

    {% if not db_backed %}
      <p class="muted">
        ØªØ¹Ø°Ù‘Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ø£Ù† Ù…ÙˆØ¯ÙŠÙ„ <code>ReportType</code> ØºÙŠØ± Ù…ÙØ¹Ù‘Ù„.
        ØªÙØ¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¯Ù†Ø§Ù‡ Ù…Ø±Ø¬Ø¹ÙŠØ© ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ø­Ù‚Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ.
      </p>
    {% endif %}

    <div class="table-wrap" role="region" aria-label="Ø¬Ø¯ÙˆÙ„ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±">
      <table>
        <thead>
          <tr>
            <th>Ø§Ù„ØªØ±ØªÙŠØ¨</th>
            <th>Ø§Ù„Ø±Ù…Ø² (code)</th>
            <th>Ø§Ù„Ø§Ø³Ù…</th>
            <th>Ù†Ø´Ø·</th>
            <th>ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø±ØªØ¨Ø·Ø©</th>
            {% if db_backed %}<th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>{% endif %}
          </tr>
        </thead>
        <tbody>
          {% for it in items %}
            <tr>
              <td data-label="Ø§Ù„ØªØ±ØªÙŠØ¨">{{ it.order|default:"â€”" }}</td>
              <td data-label="Ø§Ù„Ø±Ù…Ø²"><span class="badge">{{ it.code }}</span></td>
              <td data-label="Ø§Ù„Ø§Ø³Ù…">{{ it.name }}</td>
              <td data-label="Ù†Ø´Ø·">{% if it.is_active %}âœ…{% else %}â›”{% endif %}</td>
              <td data-label="ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø±ØªØ¨Ø·Ø©">{{ it.count|default:0 }}</td>

              {% if db_backed %}
              <td class="actions" data-label="Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª">
                <a class="btn" href="{% url 'reports:reporttype_update' it.obj.pk %}">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                <form method="post" action="{% url 'reports:reporttype_delete' it.obj.pk %}"
                      onsubmit="return confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ØŸ Ù„Ù† ÙŠÙØ³Ù…Ø­ Ø¨Ø§Ù„Ø­Ø°Ù Ø¥Ù† ÙƒØ§Ù† Ù…Ø³ØªØ®Ø¯Ù…Ù‹Ø§.');">
                  {% csrf_token %}
                  <button class="btn btn-danger" type="submit">ğŸ—‘ Ø­Ø°Ù</button>
                </form>
              </td>
              {% endif %}
            </tr>
          {% empty %}
            <tr><td colspan="{% if db_backed %}6{% else %}5{% endif %}" class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†ÙˆØ§Ø¹ Ø¨Ø¹Ø¯.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</div>
{% endblock %}
