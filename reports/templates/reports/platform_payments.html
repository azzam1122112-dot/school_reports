{# reports/templates/reports/platform_payments_list.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª{% endblock %}

{% block head %}
<style>
  /* =========================================================
     PLATFORM PAYMENTS LIST (page-only)
     - Scoped Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¯Ø§Ø®Ù„ .paylist-scope
     - Ø¨Ø¯ÙˆÙ† Ù„Ù…Ø³ :root ÙˆÙ„Ø§ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ .btn/.card
     - Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ html[data-theme="dark"]
     ========================================================= */

  .paylist-scope{max-width:1400px;margin:auto;padding:clamp(10px,2.2vw,18px)}

  .paylist-hero{
    background:
      radial-gradient(900px 220px at 15% 0%, rgba(37,99,235,.16), transparent 55%),
      radial-gradient(700px 220px at 85% 90%, rgba(16,185,129,.12), transparent 60%),
      linear-gradient(135deg, rgba(37,99,235,.94), rgba(59,130,246,.86));
    color:#fff;
    border:1px solid rgba(255,255,255,.16);
    border-radius:18px;
    box-shadow:var(--shadow);
    padding:clamp(14px,2.2vw,18px) clamp(14px,3vw,22px);
    margin-bottom:14px;
    position:relative;
    overflow:hidden;
  }
  .paylist-hero::before{
    content:"";
    position:absolute;
    inset:-2px;
    background:
      radial-gradient(closest-side, rgba(255,255,255,.12), transparent 60%) 18% 10%/240px 240px no-repeat,
      radial-gradient(closest-side, rgba(255,255,255,.09), transparent 60%) 86% 82%/280px 280px no-repeat;
    opacity:.9;
    pointer-events:none;
  }
  .paylist-hero-top{position:relative;display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}
  .paylist-title{margin:0;font-weight:950;font-size:clamp(1.15rem,2.4vw,1.55rem);display:flex;align-items:center;gap:10px}
  .paylist-sub{margin:6px 0 0;opacity:.95;font-weight:850;line-height:1.6}

  .paylist-chip{
    display:inline-flex;align-items:center;gap:8px;
    padding:8px 12px;border-radius:999px;
    background:rgba(255,255,255,.14);
    border:1px solid rgba(255,255,255,.22);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    font-weight:900;
    text-decoration:none;
    color:#fff;
    white-space:nowrap;
    transition: var(--t-fast);
  }
  .paylist-chip:hover{transform:translateY(-1px);background:rgba(255,255,255,.18)}

  /* KPIs */
  .paylist-scope .kpis{display:grid;gap:12px;margin-bottom:14px}
  @media(min-width:900px){.paylist-scope .kpis{grid-template-columns:repeat(4,1fr)}}

  .paylist-scope .kpi{
    background:var(--card);
    border:1px solid var(--line-2);
    border-radius:16px;
    box-shadow:var(--shadow);
    padding:14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .paylist-scope .kpi .num{font-weight:950;font-size:1.35rem;color:var(--ink)}
  .paylist-scope .kpi .lbl{color:var(--muted);font-weight:850;margin-top:2px}
  .paylist-scope .kpi .ico{
    width:44px;height:44px;border-radius:14px;
    display:grid;place-items:center;
    font-size:1.2rem;
    border:1px solid rgba(15,23,42,.06);
  }
  html[data-theme="dark"] .paylist-scope .kpi .ico{border-color:rgba(255,255,255,.08)}

  .paylist-scope .ico-ok{background:rgba(16,185,129,.12);color:rgba(5,150,105,1)}
  .paylist-scope .ico-warn{background:rgba(245,158,11,.12);color:rgba(217,119,6,1)}
  .paylist-scope .ico-danger{background:rgba(239,68,68,.12);color:rgba(220,38,38,1)}
  .paylist-scope .ico-info{background:rgba(37,99,235,.12);color:rgba(37,99,235,1)}

  /* Card wrapper */
  .paylist-scope .paylist-card{
    background:var(--card);
    border:1px solid var(--line-2);
    border-radius:18px;
    box-shadow:var(--shadow);
    overflow:hidden;
  }
  .paylist-scope .paylist-toolbar{
    padding:12px 14px;
    border-bottom:1px solid var(--line-2);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    flex-wrap:wrap;
  }
  .paylist-scope .muted{color:var(--muted);font-weight:850}

  .paylist-scope .pill{
    display:inline-flex;align-items:center;gap:8px;
    padding:6px 10px;border-radius:999px;
    border:1px solid var(--line-2);
    background:rgba(248,250,252,.7);
    color:var(--ink);
    font-weight:900;
    white-space:nowrap;
  }
  html[data-theme="dark"] .paylist-scope .pill{background:rgba(255,255,255,.04)}

  /* Table */
  .paylist-scope .table-responsive{border:0}
  .paylist-scope .rtable thead th{white-space:nowrap}
  .paylist-scope .rtable tbody tr:hover{background:rgba(37,99,235,.04)}
  html[data-theme="dark"] .paylist-scope .rtable tbody tr:hover{background:rgba(37,99,235,.10)}

  /* Buttons */
  .paylist-scope .btn-min{min-height:38px;padding:8px 10px;border-radius:12px}

  /* Accessibility / reduce motion */
  @media (prefers-reduced-motion: reduce){
    .paylist-chip{transition:none !important}
    .paylist-chip:hover{transform:none !important}
  }
</style>
{% endblock %}

{% block content %}
<div class="paylist-scope" dir="rtl">

  <section class="paylist-hero" aria-label="Ø±Ø£Ø³ ØµÙØ­Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª">
    <div class="paylist-hero-top">
      <div>
        <h1 class="paylist-title">
          <i class="fa-solid fa-sack-dollar" aria-hidden="true"></i>
          Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª
        </h1>
        <p class="paylist-sub">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù†ØµØ©.</p>
      </div>

      <a class="paylist-chip" href="{% url 'reports:platform_admin_dashboard' %}">
        <i class="fa-solid fa-arrow-right" aria-hidden="true"></i>
        Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù†ØµØ©
      </a>
    </div>
  </section>

  {# âœ… Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© â€” Ù„Ù† ØªÙƒØ³Ø± Ø§Ù„ØµÙØ­Ø© Ø¥Ø°Ø§ Ù„Ù… ØªÙ…Ø±Ø±Ù‡Ø§ Ù…Ù† Ø§Ù„Ù€ view #}
  <section class="kpis" aria-label="Ù…Ø¤Ø´Ø±Ø§Øª Ø³Ø±ÙŠØ¹Ø©">
    <div class="kpi">
      <div>
        <div class="num">{% if payments_total %}{{ payments_total }}{% else %}â€”{% endif %}</div>
        <div class="lbl">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª</div>
      </div>
      <div class="ico ico-info" aria-hidden="true">ğŸ“¦</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{% if payments_pending %}{{ payments_pending }}{% else %}â€”{% endif %}</div>
        <div class="lbl">Ù…Ø¹Ù„Ù‘Ù‚Ø©</div>
      </div>
      <div class="ico ico-warn" aria-hidden="true">â³</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{% if payments_approved %}{{ payments_approved }}{% else %}â€”{% endif %}</div>
        <div class="lbl">Ù…Ù‚Ø¨ÙˆÙ„Ø©</div>
      </div>
      <div class="ico ico-ok" aria-hidden="true">âœ…</div>
    </div>

    <div class="kpi">
      <div>
        <div class="num">{% if payments_rejected %}{{ payments_rejected }}{% else %}â€”{% endif %}</div>
        <div class="lbl">Ù…Ø±ÙÙˆØ¶Ø©</div>
      </div>
      <div class="ico ico-danger" aria-hidden="true">â›”</div>
    </div>
  </section>

  <div class="paylist-card">
    <div class="paylist-toolbar">
      <div class="muted">
        <i class="fa-regular fa-circle-check" aria-hidden="true"></i>
        <span>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ â€œØªÙØ§ØµÙŠÙ„â€ Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„ ÙˆØ§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø±.</span>
      </div>
      <span class="pill">
        <i class="fa-solid fa-shield-halved" aria-hidden="true"></i>
        Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¢Ù…Ù†Ø©
      </span>
    </div>

    <div class="table-responsive">
      <table class="rtable">
        <thead>
          <tr>
            <th style="text-align:right">Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</th>
            <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</th>
            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
            <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
          </tr>
        </thead>
        <tbody>
          {% for payment in payments %}
          <tr>
            <td data-label="Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" style="text-align:right;font-weight:950">
              {% firstof payment.school.name "â€”" %}
            </td>

            <td data-label="Ø§Ù„Ù…Ø¨Ù„Øº" style="font-weight:950;color:var(--brand)">
              {% if payment.amount %}{{ payment.amount }}{% else %}0{% endif %} Ø±ÙŠØ§Ù„
            </td>

            <td data-label="Ø§Ù„ØªØ§Ø±ÙŠØ®">
              {% if payment.payment_date %}{{ payment.payment_date|date:"Y-m-d" }}{% else %}-{% endif %}
            </td>

            <td data-label="Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©" style="font-family:monospace">
              {{ payment.transaction_id|default:"-" }}
            </td>

            <td data-label="Ø§Ù„Ø­Ø§Ù„Ø©">
              {% if payment.status == 'approved' %}
                <span class="badge success">Ù…Ù‚Ø¨ÙˆÙ„</span>
              {% elif payment.status == 'pending' %}
                <span class="badge warning">Ù…Ø¹Ù„Ù‘Ù‚</span>
              {% elif payment.status == 'rejected' %}
                <span class="badge danger">Ù…Ø±ÙÙˆØ¶</span>
              {% else %}
                <span class="badge" style="background:rgba(100,116,139,.12);color:#475569;border:1px solid rgba(100,116,139,.25);font-weight:950">
                  ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ
                </span>
              {% endif %}
            </td>

            <td data-label="Ø¥Ø¬Ø±Ø§Ø¡">
              <a
                href="{% url 'reports:platform_payment_detail' payment.id %}"
                class="btn btn-outline btn-min"
                aria-label="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"
              >
                ØªÙØ§ØµÙŠÙ„
              </a>
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="6" style="padding:22px;text-align:center" class="muted">
              Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„ÙŠØ§Øª Ø¯ÙØ¹ Ù…Ø³Ø¬Ù„Ø©.
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

</div>
{% endblock %}
