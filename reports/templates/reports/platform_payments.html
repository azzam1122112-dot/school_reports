{% extends "base.html" %}
{% block title %}المالية والمدفوعات{% endblock %}

{% block content %}
<div class="container" dir="rtl">
  <div class="page-head">
    <div>
      <h1 class="page-title">المالية والمدفوعات</h1>
      <p class="page-subtitle">مراجعة المدفوعات وتأكيد التحويلات على مستوى المنصة.</p>
    </div>
    <a href="{% url 'reports:platform_admin_dashboard' %}" class="btn btn-outline">عودة للوحة المنصة</a>
  </div>

  <div class="card table-responsive">
    <table class="rtable">
      <thead>
        <tr>
          <th style="text-align:right">المدرسة</th>
          <th>المبلغ</th>
          <th>التاريخ</th>
          <th>رقم العملية</th>
          <th>الحالة</th>
          <th>إجراءات</th>
        </tr>
      </thead>
      <tbody>
        {% for payment in payments %}
        <tr>
          <td data-label="المدرسة" style="text-align:right;font-weight:950">{{ payment.school.name }}</td>
          <td data-label="المبلغ" style="font-weight:950;color:var(--brand)">{{ payment.amount }} ريال</td>
          <td data-label="التاريخ">{{ payment.payment_date|date:"Y-m-d" }}</td>
          <td data-label="رقم العملية" style="font-family:monospace">{{ payment.transaction_id|default:"-" }}</td>
          <td data-label="الحالة">
            {% if payment.status == 'approved' %}
              <span class="badge success">مقبول</span>
            {% elif payment.status == 'pending' %}
              <span class="badge warning">معلّق</span>
            {% else %}
              <span class="badge danger">مرفوض</span>
            {% endif %}
          </td>
          <td data-label="إجراء">
            <a href="{% url 'reports:platform_payment_detail' payment.id %}" class="btn btn-outline" style="min-height:38px;padding:8px 10px">تفاصيل</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" style="padding:20px;text-align:center" class="muted">لا توجد عمليات دفع مسجلة.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
