<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>{{ title }}</title>
  <style>
    @page {
      size: A4;
      margin: 26mm 16mm 18mm 16mm;
      @top-center {
        content: element(page-header);
      }
      @bottom-center {
        content: element(page-footer);
      }
    }

    html, body {
      padding: 0;
      margin: 0;
    }

    body {
      font-family: "Noto Naskh Arabic", "Amiri", "Segoe UI", Tahoma, Arial, sans-serif;
      direction: rtl;
      color: #1f2937;
      line-height: 1.8;
      font-size: 11.3pt;
      background: #fff;
    }

    .header {
      position: running(page-header);
      display: table;
      width: 100%;
      border-bottom: 1px solid #d1d5db;
      padding-bottom: 6mm;
    }

    .header-content {
      display: table-row;
    }

    .brand {
      display: table-cell;
      vertical-align: middle;
      text-align: right;
    }

    .brand img {
      height: 12mm;
      width: auto;
      vertical-align: middle;
      margin-left: 4mm;
    }

    .brand-text {
      display: inline-block;
      vertical-align: middle;
    }

    .brand-name {
      font-size: 13.5pt;
      font-weight: 800;
      margin: 0;
      color: #111827;
    }

    .brand-subtitle {
      font-size: 9pt;
      margin: 1.2mm 0 0;
      color: #4b5563;
      font-weight: 500;
    }

    .header-title {
      display: table-cell;
      vertical-align: middle;
      text-align: left;
    }

    .header-title-text {
      margin: 0;
      font-weight: 700;
      font-size: 11.5pt;
      color: #1d4ed8;
    }

    .header-date {
      margin: 1.5mm 0 0;
      font-size: 8.7pt;
      color: #6b7280;
    }

    main {
      padding: 0;
    }

    .guide-body {
      margin-top: 2mm;
    }

    h1 {
      font-size: 18pt;
      font-weight: 800;
      color: #1e3a8a;
      margin: 0 0 5mm;
      line-height: 1.45;
      border-bottom: 1.2px solid #d1d5db;
      padding-bottom: 2.5mm;
      page-break-after: avoid;
    }

    h2 {
      font-size: 15pt;
      font-weight: 700;
      color: #1d4ed8;
      margin: 8mm 0 3mm;
      border-bottom: 1px solid #e5e7eb;
      padding-bottom: 2mm;
      page-break-after: avoid;
    }

    h3 {
      font-size: 12.5pt;
      font-weight: 600;
      color: #334155;
      margin: 5mm 0 2mm;
      page-break-after: avoid;
    }

    h4 {
      font-size: 11.6pt;
      font-weight: 600;
      color: #475569;
      margin: 4mm 0 1.6mm;
      page-break-after: avoid;
    }

    p {
      margin: 1.5mm 0 2.6mm;
      color: #1f2937;
      text-align: justify;
      orphans: 3;
      widows: 3;
    }

    ul, ol {
      margin: 1.5mm 0 2.5mm;
      padding-right: 6mm;
      color: #374151;
    }

    li {
      margin: 1.2mm 0;
      line-height: 1.8;
    }

    ul li::marker {
      color: #7c3aed;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 4mm 0;
      page-break-inside: avoid;
    }

    th {
      background: #eef2ff;
      color: #1e3a8a;
      border: 1px solid #dbeafe;
      padding: 2.2mm 2.8mm;
      font-weight: 700;
      text-align: right;
      font-size: 10.6pt;
    }

    td {
      border: 1px solid #e5e7eb;
      padding: 2.2mm 2.8mm;
      vertical-align: top;
      color: #374151;
    }

    code {
      font-family: "Cascadia Mono", Consolas, "Courier New", monospace;
      font-size: 9.4pt;
      background: #f3f4f6;
      padding: 0.4mm 1.4mm;
      border-radius: 2px;
      color: #111827;
      direction: ltr;
      unicode-bidi: isolate;
    }

    pre {
      background: #f8fafc;
      color: #0f172a;
      padding: 3mm;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      overflow-wrap: anywhere;
      line-height: 1.6;
      page-break-inside: avoid;
    }

    pre code {
      background: none;
      border: none;
      color: inherit;
      padding: 0;
    }

    a {
      color: #1d4ed8;
      text-decoration: none;
      font-weight: 600;
    }

    blockquote {
      background: #fffbeb;
      border-right: 3px solid #f59e0b;
      padding: 2.5mm 3mm;
      margin: 3mm 0;
      color: #78350f;
      page-break-inside: avoid;
    }

    strong, b {
      color: #0f172a;
      font-weight: 700;
    }

    em, i {
      color: #334155;
    }

    .footer {
      position: running(page-footer);
      border-top: 1px solid #d1d5db;
      padding-top: 3mm;
      font-size: 8.8pt;
      color: #6b7280;
    }

    .footer-content {
      display: table;
      width: 100%;
    }

    .footer-left {
      display: table-cell;
      text-align: right;
      vertical-align: middle;
    }

    .footer-right {
      display: table-cell;
      text-align: left;
      vertical-align: middle;
      font-weight: 600;
      color: #374151;
    }

    .page-number::before {
      content: counter(page);
    }

    .page-count::before {
      content: counter(pages);
    }

    img, table, pre, blockquote {
      page-break-inside: avoid;
    }

    h1, h2, h3, h4 {
      page-break-after: avoid;
    }

    p + ul, p + ol, h2 + ul, h2 + ol, h3 + ul, h3 + ol {
      page-break-before: avoid;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-content">
      <div class="brand">
        <img src="{{ logo_url }}" alt="Logo" />
        <div class="brand-text">
          <p class="brand-name">منصة توثيق</p>
          <p class="brand-subtitle">نظام إدارة التقارير والإنجازات</p>
        </div>
      </div>
      <div class="header-title">
        <p class="header-title-text">دليل المستخدم الشامل</p>
        <p class="header-date">الإصدار 2026</p>
      </div>
    </div>
  </div>

  <main>
    <div class="guide-body">{{ guide_html|safe }}</div>
  </main>

  <div class="footer">
    <div class="footer-content">
      <div class="footer-left">
        <div>منصة توثيق © 2026 — جميع الحقوق محفوظة</div>
        <div>تم التوليد تلقائيًا من النظام</div>
      </div>
      <div class="footer-right">
        صفحة <span class="page-number"></span> من <span class="page-count"></span>
      </div>
    </div>
  </div>
</body>
</html>
