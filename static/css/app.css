/* =========================================================
   app.css — نظام تقارير (RTL) — نسخة محسّنة 2026 (Drop-in)
   ✅ تحافظ على أسماء الكلاسات الحالية
   ✅ تحسين بصري + UX + مكوّنات إضافية بدون كسر القوالب
   ✅ تحسينات طباعة/WeasyPrint + دعم safe-area + RTL + Dark
   ✅ إصلاحات توافق (color-mix / backdrop-filter / iOS)
========================================================= */

/* ========== 1) Design Tokens ========== */
:root{
  /* Typography */
  --font: "Tajawal", system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", sans-serif;

  /* Brand */
  --brand: #2563eb;
  --brand-700: #1d4ed8;
  --brand-ink: #1e3a8a;
  --brand-ghost: rgba(37,99,235,.10);

  --accent: #059669;
  --danger: #dc2626;
  --warning: #f59e0b;
  --info: #0ea5e9;

  /* Neutrals */
  --ink: #0f172a;
  --ink-soft: #1f2937;
  --muted: #64748b;
  --bg: #f5f7fb;
  --card: #ffffff;
  --line: #e2e8f0;
  --line-2: #eef2f7;

  /* Radii */
  --radius-sm: 10px;
  --radius: 14px;
  --radius-lg: 18px;
  --radius-xl: 22px;

  /* Shadows */
  --shadow-sm: 0 4px 14px rgba(2,6,23,.06);
  --shadow:    0 10px 28px rgba(2,6,23,.10);
  --shadow-lg: 0 22px 60px rgba(2,6,23,.14);

  /* Focus ring */
  --ring: 0 0 0 3px rgba(37,99,235,.22);

  /* Tap target */
  --tap: 48px;

  /* Spacing */
  --s-1: 6px;
  --s-2: 10px;
  --s-3: 14px;
  --s-4: 18px;
  --s-5: 24px;
  --s-6: 32px;

  /* Motion */
  --t-fast: .12s;
  --t: .18s;
  --ease: cubic-bezier(.2,.8,.2,1);

  /* Z */
  --z-header: 20;
  --z-modal: 80;
  --z-toast: 90;

  /* Safe areas */
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

/* Dark mode (يدوي عبر data-theme="dark") */
html[data-theme="dark"]{
  color-scheme: dark;
  --bg:#050816;
  --card: rgba(15,23,42,.86);
  --line: rgba(148,163,184,.16);
  --line-2: rgba(148,163,184,.10);
  --ink:#e5e7eb;
  --ink-soft:#e2e8f0;
  --muted: rgba(226,232,240,.70);
  --shadow-sm: 0 8px 26px rgba(0,0,0,.35);
  --shadow:    0 16px 48px rgba(0,0,0,.45);
  --shadow-lg: 0 24px 72px rgba(0,0,0,.55);
}

/* ========== 2) Reset / Base ========== */
*{box-sizing:border-box}
html,body{
  margin:0;
  padding:0;
  height:100%;
  width:100%;
  overflow-x:hidden;
}

/* RTL safety: إذا dir="rtl" موجود لن يضر */
html{direction: rtl}

body{
  font-family: var(--font);
  font-size: 0.94rem;
  color: var(--ink);
  line-height: 1.7;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;

  /* Background ناعم */
  background:
    radial-gradient(1200px 520px at 10% 0%, rgba(37,99,235,.10), transparent 60%),
    radial-gradient(900px 420px at 90% 10%, rgba(5,150,105,.10), transparent 55%),
    linear-gradient(180deg, var(--bg), var(--bg));
}

img{max-width:100%;display:block}
a{color:inherit;text-underline-offset:3px}
a:hover{color:var(--brand)}
button,input,select,textarea{font:inherit}
::selection{background:rgba(37,99,235,.18)}

:focus-visible{outline:none; box-shadow: var(--ring); border-color: rgba(37,99,235,.35)}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  *{animation:none!important;transition:none!important;scroll-behavior:auto!important}
}

/* Helpers */
.muted{color:var(--muted)}
.sr-only{
  position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;
  overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;
}
.divider{height:1px;background:var(--line-2);margin:var(--s-4) 0}

/* ========== 3) Layout Helpers ========== */
.container{
  width:100%;
  max-width:1240px;
  margin-inline:auto;
  padding:0 clamp(12px, 3vw, 24px);
}

body.page{
  min-height:100dvh;
  display:flex;
  flex-direction:column;
}

.page-main{
  flex:1 0 auto;
  padding-block:clamp(12px, 2.5vw, 24px);
  animation:fadeUp .45s var(--ease) both;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

.row-between{display:flex;align-items:center;justify-content:space-between;gap:10px}
.stack{display:grid;gap:var(--s-3)}
.grid{display:grid;gap:var(--s-3)}
.grid-2{grid-template-columns:repeat(2,1fr)}
@media(min-width: 900px){
  .grid-3{grid-template-columns:repeat(3,1fr)}
  .grid-4{grid-template-columns:repeat(4,1fr)}
}

/* Visibility helpers */
.desktop-only{display:block}
.mobile-only{display:none}

/* ========== 4) Header / Nav ========== */
.site-header{
  background:rgba(255,255,255,.86);
  border-bottom:1px solid var(--line-2);
  position:sticky;
  top:0;
  z-index:var(--z-header);
  backdrop-filter:blur(10px) saturate(180%);
}
@supports not (backdrop-filter: blur(10px)){
  .site-header{background:#fff}
}
html[data-theme="dark"] .site-header{background:rgba(10,16,32,.70)}

.brand{
  font-weight:950;
  color:var(--ink);
  display:flex;
  align-items:center;
  gap:10px;
  text-decoration:none;
  letter-spacing:.2px;
}
.brand img{
  width:40px;height:40px;
  object-fit:contain;
  border-radius:12px;
  border:1px solid var(--line-2);
  background:rgba(255,255,255,.60);
}

.nav .link{
  margin-inline:6px;
  color:var(--brand);
  text-decoration:none;
  font-weight:900;
  padding:8px 10px;
  border-radius:12px;
  transition:transform var(--t-fast) var(--ease), background var(--t-fast) var(--ease), color var(--t-fast) var(--ease);
}
.nav .link:hover{background:var(--brand-ghost);transform:translateY(-1px)}
.nav .link[aria-current="page"]{background:var(--brand-ghost);color:var(--brand-700)}

/* ========== 5) Cards / Sections ========== */
.card{
  background:var(--card);
  border:1px solid var(--line-2);
  border-radius:var(--radius-lg);
  box-shadow:var(--shadow-sm);
  padding:16px;
}

.card.soft{background:rgba(255,255,255,.86)} /* fallback */
html[data-theme="dark"] .card.soft{background:rgba(15,23,42,.72)}
@supports (background: color-mix(in srgb, white 50%, transparent)){
  .card.soft{background:color-mix(in srgb, var(--card) 86%, transparent)}
}

.section-title{
  margin:4px 0 12px;
  font-size:1.08rem;
  font-weight:950;
  color:var(--ink);
}
.section-sub{
  margin:-8px 0 10px;
  color:var(--muted);
  font-weight:800;
  font-size:.92rem;
}

/* ========== 6) Buttons ========== */
.btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  min-height:var(--tap);
  padding:10px 14px;
  border-radius:12px;
  border:1px solid transparent;
  cursor:pointer;
  font-weight:950;
  text-decoration:none;
  transition:
    transform var(--t-fast) var(--ease),
    box-shadow var(--t) var(--ease),
    background var(--t) var(--ease),
    border-color var(--t) var(--ease),
    opacity var(--t) var(--ease);
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}
.btn:hover{transform:translateY(-1px);box-shadow:0 10px 26px rgba(2,6,23,.10)}
.btn:active{transform:translateY(0)}
.btn:disabled,
.btn[aria-disabled="true"]{
  opacity:.55;
  cursor:not-allowed;
  transform:none!important;
  box-shadow:none!important;
}

.btn-sm{min-height:40px;padding:8px 12px;border-radius:12px;font-weight:900}
.btn-lg{min-height:56px;padding:12px 16px;border-radius:14px}
.btn-block{width:100%}

.btn-primary{
  background:linear-gradient(135deg, var(--brand), #4f46e5);
  color:#fff;
  border-color:rgba(37,99,235,.35);
}
.btn-primary:hover{background:linear-gradient(135deg, var(--brand-700), #4338ca)}
.btn-accent{
  background:linear-gradient(135deg, var(--accent), #22c55e);
  color:#fff;
  border-color:rgba(5,150,105,.30);
}
.btn-accent:hover{filter:brightness(.98)}
.btn-danger{
  background:linear-gradient(135deg, var(--danger), #ef4444);
  color:#fff;
  border-color:rgba(220,38,38,.30);
}
.btn-danger:hover{filter:brightness(.98)}
.btn-outline{
  background:transparent;
  color:var(--brand);
  border-color:rgba(37,99,235,.25);
}
.btn-outline:hover{background:var(--brand-ghost)}

/* Loading state: ضع data-loading="1" */
.btn[data-loading="1"]{pointer-events:none;opacity:.85}
.btn[data-loading="1"]::after{
  content:"";
  width:16px;height:16px;
  border-radius:999px;
  border:2px solid rgba(255,255,255,.55);
  border-top-color:rgba(255,255,255,1);
  animation:spin .8s linear infinite;
}
.btn.btn-outline[data-loading="1"]::after{
  border-color:rgba(37,99,235,.30);
  border-top-color:rgba(37,99,235,1);
}
@keyframes spin{to{transform:rotate(360deg)}}

/* ========== 6.5) Admin / Dashboard Helpers ========== */
.page-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:14px;
}
.page-head .page-title{
  margin:0;
  font-weight:950;
  color:var(--ink-soft);
  font-size:1.18rem;
}
.page-head .page-subtitle{
  margin:4px 0 0;
  color:var(--muted);
  font-weight:800;
}

.page-hero{
  border:1px solid var(--line-2);
  background:
    radial-gradient(900px 380px at 15% 10%, rgba(255,255,255,.16), transparent 55%),
    linear-gradient(135deg, var(--brand-700), var(--info));
  color:#fff;
  box-shadow:var(--shadow);
}
.page-hero .page-title,
.page-hero .page-subtitle{color:#fff}
.page-hero .hero-badge{
  background:rgba(255,255,255,.14);
  border:1px solid rgba(255,255,255,.22);
  border-radius:999px;
  padding:10px 12px;
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:950;
}
.page-hero .hero-ava{
  width:38px;height:38px;
  border-radius:999px;
  background:rgba(2,6,23,.18);
  border:1px solid rgba(255,255,255,.18);
  display:grid;
  place-items:center;
  font-weight:950;
}

.kpi-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:12px;
}
@media(min-width: 900px){
  .kpi-grid{grid-template-columns:repeat(4,1fr)}
}
.kpi{
  background:var(--card);
  border:1px solid var(--line-2);
  border-radius:var(--radius-lg);
  box-shadow:var(--shadow-sm);
  padding:14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.kpi .num{font-weight:950;font-size:1.45rem;line-height:1;color:var(--ink)}
.kpi .lbl{color:var(--muted);font-weight:900;margin-top:6px}
.kpi .kpi-ico{
  width:42px;height:42px;
  border-radius:14px;
  display:grid;
  place-items:center;
  border:1px solid rgba(15,23,42,.06);
}
.kpi .kpi-ico.info{background:rgba(37,99,235,.10);color:var(--brand)}
.kpi .kpi-ico.warn{background:rgba(245,158,11,.14);color:var(--warning)}
.kpi .kpi-ico.danger{background:rgba(220,38,38,.12);color:var(--danger)}
.kpi .kpi-ico.ok{background:rgba(5,150,105,.12);color:var(--accent)}

.badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  font-size:.82rem;
  font-weight:950;
  border:1px solid var(--line-2);
  background:rgba(148,163,184,.14);
  color:var(--ink);
  white-space:nowrap;
}
.badge.success{background:rgba(5,150,105,.12);color:var(--accent);border-color:rgba(5,150,105,.22)}
.badge.warning{background:rgba(245,158,11,.14);color:var(--warning);border-color:rgba(245,158,11,.28)}
.badge.danger{background:rgba(220,38,38,.12);color:var(--danger);border-color:rgba(220,38,38,.24)}
.badge.info{background:rgba(37,99,235,.10);color:var(--brand);border-color:rgba(37,99,235,.20)}

/* ========== 7) Forms / Inputs ========== */
label{font-weight:900;color:var(--ink-soft)}
.helptext{color:var(--muted);font-weight:800;font-size:.88rem;margin-top:6px}
.required-star{color:var(--danger);margin-inline-start:4px}

.errorlist{
  margin:10px 0 0;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(220,38,38,.22);
  background:rgba(220,38,38,.08);
  color:rgba(220,38,38,.96);
  font-weight:900;
  list-style:none;
}
.errorlist li{margin:0}

.form-grid{display:grid;grid-template-columns:1fr;gap:12px}

.input,.textarea,.select,
input[type="date"],input[type="number"],input[type="text"],input[type="file"],input[type="password"],input[type="search"],textarea,select{
  width:100%;
  padding:11px 12px;
  border:1px solid rgba(15,23,42,.14);
  border-radius:12px;
  background:var(--card);
  color:var(--ink);
  box-shadow:0 1px 0 rgba(2,6,23,.02);
  transition:box-shadow var(--t) var(--ease), border-color var(--t) var(--ease), background var(--t) var(--ease);
}
textarea,.textarea{min-height:110px;resize:vertical}
input::placeholder,textarea::placeholder{color:rgba(100,116,139,.85)}
input:focus,textarea:focus,select:focus{outline:none;box-shadow:var(--ring);border-color:rgba(37,99,235,.35)}
input:disabled,textarea:disabled,select:disabled{opacity:.65;cursor:not-allowed}

/* File input nicer */
input[type="file"]{padding:10px}
input[type="file"]::file-selector-button{
  border:1px solid rgba(37,99,235,.25);
  background:var(--brand-ghost);
  color:var(--brand-700);
  border-radius:10px;
  padding:8px 12px;
  font-weight:900;
  cursor:pointer;
  margin-inline-end:10px;
}

/* Filters */
.filters{display:grid;grid-template-columns:1fr;gap:10px;margin:8px 0 12px}
.filters .actions{display:flex;gap:8px;flex-wrap:wrap}

/* ========== 8) Tables / Cards responsive list ========== */
.table-wrap{display:none;overflow:auto}
.table-wrap,.table-responsive{
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
}
.table-wrap::-webkit-scrollbar,
.table-responsive::-webkit-scrollbar{height:10px}
.table-wrap::-webkit-scrollbar-thumb,
.table-responsive::-webkit-scrollbar-thumb{background:rgba(100,116,139,.35);border-radius:999px}

table{width:100%;border-collapse:collapse;background:transparent}
thead th{
  background:rgba(248,250,252,.9);
  color:var(--muted);
  font-weight:950;
}
html[data-theme="dark"] thead th{background:rgba(148,163,184,.08)}
th,td{
  padding:12px 10px;
  border-bottom:1px solid var(--line-2);
  text-align:center;
  vertical-align:middle;
}

/* Zebra */
tbody tr:nth-child(odd) td{background:rgba(2,6,23,.012)}
html[data-theme="dark"] tbody tr:nth-child(odd) td{background:rgba(255,255,255,.03)}
tbody tr:hover td{background:rgba(37,99,235,.04)}

/* Sticky header */
.table-sticky thead th{position:sticky;top:0;z-index:2}

/* Cards (mobile) */
.cards{display:grid;grid-template-columns:1fr;gap:12px}
.card-row{display:grid;grid-template-columns:1fr 1fr;gap:6px}
.card-row span{color:var(--muted);font-size:.92rem;font-weight:900}
.card-row b{color:var(--ink)}

/* Responsive table helper */
.rtable{width:100%;border-collapse:collapse}
@media(max-width: 860px){
  .rtable thead{display:none}
  .rtable,.rtable tbody,.rtable tr,.rtable td{display:block;width:100%}
  .rtable tr{
    border:1px solid var(--line-2);
    border-radius:var(--radius-lg);
    margin:10px 0;
    background:var(--card);
    box-shadow:var(--shadow-sm);
    overflow:hidden;
  }
  .rtable td{border-bottom:1px dashed var(--line-2);text-align:right;padding:12px}
  .rtable td:last-child{border-bottom:0}
  .rtable td[data-label]::before{
    content:attr(data-label);
    display:inline-block;
    margin-inline-start:6px;
    color:var(--muted);
    font-weight:950;
  }
}

/* ========== 9) Images / Thumbs ========== */
.imgs{display:flex;gap:8px;flex-wrap:wrap}
.imgs img{
  width:100%;
  max-width:110px;
  height:auto;
  border-radius:12px;
  border:1px solid var(--line-2);
  box-shadow:0 8px 18px rgba(2,6,23,.06);
  cursor:zoom-in;
  transition:transform var(--t) var(--ease), box-shadow var(--t) var(--ease);
}
.imgs img:hover{transform:translateY(-1px);box-shadow:0 14px 28px rgba(2,6,23,.12)}

/* Attachment grid */
.attach-grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:10px;
}
@media(min-width: 768px){
  .attach-grid{grid-template-columns:repeat(4, minmax(0,1fr))}
}
.attach-item{
  border:1px solid var(--line-2);
  border-radius:14px;
  overflow:hidden;
  background:var(--card);
  box-shadow:var(--shadow-sm);
}
.attach-item img{width:100%;height:110px;object-fit:cover}
.attach-meta{padding:10px}
.attach-name{font-weight:950;font-size:.92rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.attach-actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}

/* ========== 9.5) Modal ========== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(2,6,23,.62);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:var(--z-modal);
  padding:clamp(12px, 3vw, 24px);
}
.modal.is-open{display:flex}
.modal-card{
  width:min(980px, 100%);
  background:var(--card);
  border:1px solid var(--line-2);
  border-radius:var(--radius-xl);
  box-shadow:var(--shadow-lg);
  overflow:hidden;
}
.modal-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:12px 14px;
  border-bottom:1px solid var(--line-2);
}
.modal-title{font-weight:950}
.modal-body{padding:12px}
.modal-body img{width:100%;height:auto;border-radius:14px;border:1px solid var(--line-2)}
.modal-close{
  min-height:40px;
  padding:8px 12px;
  border-radius:12px;
  border:1px solid rgba(15,23,42,.14);
  background:transparent;
  cursor:pointer;
  font-weight:950;
}

/* ========== 10) Pagination ========== */
.pgn{display:flex;gap:8px;justify-content:center;margin-top:14px;flex-wrap:wrap}
.pgn a,.pgn span{
  padding:9px 12px;
  border:1px solid rgba(15,23,42,.14);
  border-radius:12px;
  text-decoration:none;
  color:var(--ink);
  background:var(--card);
  font-weight:950;
  transition:background var(--t) var(--ease), transform var(--t-fast) var(--ease);
}
.pgn a:hover{background:rgba(37,99,235,.06);transform:translateY(-1px)}
.pgn .active{background:var(--brand);color:#fff;border-color:var(--brand)}

/* ========== 11) Messages (legacy) ========== */
.messages{margin-block:12px}
.msg{
  padding:10px 12px;
  border-radius:12px;
  background:rgba(239,246,255,.92);
  border:1px solid #bfdbfe;
  box-shadow:var(--shadow-sm);
  font-weight:900;
}
.msg.success{background:rgba(240,255,246,.92);border-color:#c8f3d6;color:#064e3b}
.msg.error{background:rgba(255,240,240,.92);border-color:#ffd4d4;color:#7f1d1d}
.msg.warning{background:rgba(255,251,235,.92);border-color:#fed7aa;color:#7c2d12}
.msg.info{background:rgba(239,246,255,.92);border-color:#bfdbfe;color:#0b1b3a}

/* Toast */
.toast{
  position:fixed;
  inset-inline:12px;
  bottom:calc(12px + var(--safe-bottom));
  z-index:var(--z-toast);
  display:none;
}
.toast.is-open{display:block}
.toast-card{
  max-width:640px;
  margin-inline:auto;
  background:var(--card);
  border:1px solid var(--line-2);
  border-radius:16px;
  box-shadow:var(--shadow-lg);
  padding:12px 14px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
}
.toast-title{font-weight:950}
.toast-text{color:var(--muted);font-weight:800;margin-top:4px}
.toast-x{
  border:1px solid rgba(15,23,42,.14);
  background:transparent;
  border-radius:12px;
  padding:8px 10px;
  cursor:pointer;
  font-weight:950;
}

/* ========== 12) Footer ========== */
.site-footer{
  margin-top:auto;
  color:#e7eefc;
  background:linear-gradient(180deg,#0b1220 0%, #0e1a2f 100%);
  position:relative;
}
.site-footer::before{
  content:"";
  position:absolute;
  inset:0 0 auto 0;
  height:3px;
  background:linear-gradient(90deg, var(--brand), var(--accent));
  opacity:.95;
}
.footer-wrap{
  display:grid;
  gap:12px;
  align-items:center;
  padding:18px 0;
}
.f-brand{display:flex;align-items:center;gap:12px}
.f-brand img{
  width:44px;height:44px;border-radius:12px;padding:8px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
}
.f-title{font-weight:950}
.f-sub{font-size:.92rem;opacity:.88}
.f-nav{display:flex;flex-wrap:wrap;gap:10px}
.f-nav a{
  color:#d7e3ff;
  text-decoration:none;
  padding:8px 10px;
  border-radius:12px;
  font-weight:950;
}
.f-nav a:hover{background:rgba(255,255,255,.08)}
.f-copy{font-size:.9rem;color:#b6c3df}

/* ========== 12.5) To top (FAB) ========== */
.to-top{
  position:fixed;
  left:clamp(12px, 2vw, 16px);
  bottom:calc(12px + var(--safe-bottom));
  width:48px;
  height:48px;
  border-radius:16px;
  border:1px solid var(--line-2);
  background:var(--card);
  color:var(--ink);
  box-shadow:var(--shadow);
  display:none;
  place-items:center;
  cursor:pointer;
  z-index:var(--z-header);
}
.to-top:hover{transform:translateY(-1px)}
.to-top:active{transform:translateY(0)}

/* ========== 13) Responsive ========== */
@media (min-width: 768px){
  .filters{grid-template-columns:repeat(4, 1fr);align-items:end}
  .cards{display:none}
  .table-wrap{display:block}
  .footer-wrap{grid-template-columns:auto 1fr auto}
  .f-copy{text-align:end}
}

@media (max-width: 820px){
  .desktop-only{display:none!important}
  .mobile-only{display:block!important}
  .row-between{flex-wrap:wrap}
}

/* Prevent iOS zoom-on-focus */
@media (max-width: 520px){
  input[type="text"], input[type="password"], input[type="search"], input[type="number"], input[type="date"],
  textarea, select{font-size:16px}
}

/* TV / large screens */
@media (min-width: 1400px){
  body{font-size:18px}
  .container{max-width:1400px}
  th,td{padding:14px 12px}
  .card{padding:18px}
}

/* =========================================================
   14) Print (تقارير/طباعة) — محسّن + WeasyPrint-friendly
   - يخفي عناصر الواجهة
   - يمنع قص الصور/التواقيع
   - يسمح للنص بالتمدد
========================================================= */
@media print{
  /* Hide UI */
  .site-header, .site-footer, .nav, .pgn, .toast, .messages, .to-top{display:none!important}

  /* IMPORTANT: لا تُخفِ .btn عالميًا لأن صفحة report_print فيها زر طباعة/تحميل
     إذا كنت تريد إخفاء أزرار معينة ضع عليها class="no-print" */
  .no-print{display:none!important}

  body{background:#fff!important}
  a{text-decoration:none!important;color:#111827!important}

  .card{
    box-shadow:none!important;
    border-color:#e5e7eb!important;
  }

  /* ثبات الألوان عند الطباعة قدر الإمكان */
  *{-webkit-print-color-adjust: exact; print-color-adjust: exact;}

  /* منع قص العناصر الحساسة */
  .photo-item, .imgs img,
  .attach-item, .attach-grid,
  .signatures-area, .sign-box, .sign-card{
    break-inside: avoid;
    page-break-inside: avoid;
  }

  /* اسمح للنص أن يكسر بحرية (حتى ما يزاحم الصور) */
  .description-box{
    break-inside: auto;
    page-break-inside: auto;
  }
}

/* =========================================================
   15) Compatibility + Mobile UX add-ons (safe append)
========================================================= */

/* Better interactive focus */
a:focus-visible,
.btn:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible{
  outline:none;
  box-shadow:var(--ring);
}

/* Prevent iOS styling + nicer selects */
button, input, textarea, select{
  -webkit-appearance:none;
  appearance:none;
}
select{
  background-image:
    linear-gradient(45deg, transparent 50%, rgba(100,116,139,.9) 50%),
    linear-gradient(135deg, rgba(100,116,139,.9) 50%, transparent 50%);
  background-position: 16px calc(50% - 2px), 10px calc(50% - 2px);
  background-size: 6px 6px, 6px 6px;
  background-repeat:no-repeat;
  padding-inline-start:12px;
  padding-inline-end:34px;
}

/* Sticky action bar (optional) */
.sticky-actions{
  position:sticky;
  bottom:0;
  z-index:5;
  background:rgba(255,255,255,.86);
  backdrop-filter:blur(10px) saturate(160%);
  border-top:1px solid var(--line-2);
  padding:10px 12px;
  padding-bottom:calc(10px + var(--safe-bottom));
}
html[data-theme="dark"] .sticky-actions{background:rgba(10,16,32,.72)}

/* Bottom sheet (optional) */
.sheet{
  position:fixed;
  inset:0;
  z-index:var(--z-modal);
  display:none;
}
.sheet.is-open{display:block}
.sheet-backdrop{position:absolute;inset:0;background:rgba(2,6,23,.55)}
.sheet-panel{
  position:absolute;
  inset-inline:0;
  bottom:0;
  border-radius:18px 18px 0 0;
  background:var(--card);
  border:1px solid var(--line-2);
  box-shadow:var(--shadow-lg);
  max-height:min(78vh, 680px);
  overflow:auto;
  padding:12px 14px;
  padding-bottom:calc(14px + var(--safe-bottom));
}
.sheet-grab{
  width:56px;height:5px;border-radius:999px;
  background:rgba(100,116,139,.35);
  margin:6px auto 10px;
}
.sheet-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}
.sheet-title{font-weight:950}
.sheet-actions{display:flex;gap:8px;flex-wrap:wrap}

/* Bottom nav (optional) */
.bottom-nav{
  position:fixed;
  inset-inline:12px;
  bottom:calc(12px + var(--safe-bottom));
  z-index:var(--z-header);
  display:none;
  background:rgba(255,255,255,.86);
  border:1px solid var(--line-2);
  border-radius:18px;
  box-shadow:var(--shadow);
  backdrop-filter:blur(10px) saturate(180%);
  padding:8px 10px;
}
.bottom-nav .items{display:flex;justify-content:space-between;gap:8px}
.bottom-nav a{
  flex:1;
  min-height:44px;
  border-radius:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  text-decoration:none;
  font-weight:950;
  color:var(--muted);
  transition:background var(--t) var(--ease), color var(--t) var(--ease);
}
.bottom-nav a:hover{background:rgba(37,99,235,.08);color:var(--brand)}
.bottom-nav a[aria-current="page"]{background:var(--brand-ghost);color:var(--brand-700)}
html[data-theme="dark"] .bottom-nav{background:rgba(10,16,32,.72)}
@media (max-width: 820px){
  .bottom-nav{display:block}
  body.has-bottom-nav .site-footer{padding-bottom:86px}
}

/* Skeleton */
.skeleton{
  position:relative;
  overflow:hidden;
  background:rgba(148,163,184,.18);
  border-radius:12px;
}
.skeleton::after{
  content:"";
  position:absolute;
  inset:0;
  transform:translateX(-100%);
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
  animation:shimmer 1.1s linear infinite;
}
html[data-theme="dark"] .skeleton::after{
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.12), transparent);
}
@keyframes shimmer{to{transform:translateX(100%)}}

/* Empty state */
.empty{
  text-align:center;
  padding:18px 14px;
  border:1px dashed var(--line);
  border-radius:var(--radius-lg);
  background:rgba(37,99,235,.04);
}
.empty .title{font-weight:950;margin:0 0 6px}
.empty .hint{color:var(--muted);font-weight:800;margin:0}
